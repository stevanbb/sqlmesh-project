var en=Object.defineProperty;var tn=(e,t,n)=>t in e?en(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var le=(e,t,n)=>(tn(e,typeof t!="symbol"?t+"":t,n),n);import{r as s,j as o,N as nn,c as B,b as _,d as Mt,a as E,e as Y,R as k,$ as et,f as Ne,g as ie,h as ct,k as ut,B as tt,l as nt,m as Ft,n as St,L as rn,S as rt,o as an,p as sn,q as on,s as Lt,t as Dt,v as M,w as ln,i as F,x as cn,y as un,z as dn,A as Ge,C as fn,D as mn,F as bt,G as hn,H as Et,O as pn}from"./index-176b79a9.js";import{R as vn}from"./ReportErrors-64911a07.js";import{u as j,M as gn,a as at,E as ue}from"./plan-e14ca7e6.js";import{b as wn,M as xn,P as yt,E as O,S as bn}from"./SelectEnvironment-4b6fb0e0.js";import{o as U,D as fe,y as me,l as Ot,n as zt,a as En,u as xe,s as Ae,O as Re,M as de,p as yn,c as jt,b as Ct,X as he,d as jn,f as It,E as Ht,e as re,t as Bt,N as Cn,g as dt,h as _t,S as kt,I as be,C as kn,i as Pe,j as Tn,k as An,m as Pn,P as st,q as ot,r as Rn,v as Nn,w as Tt,x as lt}from"./transition-19ed7834.js";import{C as $n}from"./ChevronRightIcon-3cb9e6be.js";import{u as Q,M as Xe}from"./project-e6dc9a02.js";import{M as At}from"./file-d5b08b04.js";import{u as te,c as Mn}from"./editor-d35a2632.js";import{EnumFileExplorerChange as Je}from"./context-5718240e.js";import"./PlusCircleIcon-2799ca1f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./SplitPane-94158256.js";import"./context-4c50fddd.js";import"./Input-a01139a4.js";import"./help-68063aae.js";import"./SourceList-a47c6829.js";import"./index-ae36976e.js";import"./ModelLineage-d6235abf.js";import"./ListboxShow-71b4cfa2.js";import"./SearchList-a958facb.js";import"./ChevronDownIcon-a0e0a146.js";function Fn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z",clipRule:"evenodd"}))}const Sn=s.forwardRef(Fn),Ln=Sn;function Dn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"}))}const On=s.forwardRef(Dn),zn=On;function In({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M3 3.5A1.5 1.5 0 014.5 2h6.879a1.5 1.5 0 011.06.44l4.122 4.12A1.5 1.5 0 0117 7.622V16.5a1.5 1.5 0 01-1.5 1.5h-11A1.5 1.5 0 013 16.5v-13zm10.857 5.691a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 00-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"}))}const Hn=s.forwardRef(In),Bn=Hn;function _n({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M4.5 2A1.5 1.5 0 003 3.5v13A1.5 1.5 0 004.5 18h11a1.5 1.5 0 001.5-1.5V7.621a1.5 1.5 0 00-.44-1.06l-4.12-4.122A1.5 1.5 0 0011.378 2H4.5zm2.25 8.5a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5zm0 3a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5z",clipRule:"evenodd"}))}const Vn=s.forwardRef(_n),Wn=Vn;function Yn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495zM10 5a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 0110 5zm0 9a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))}const qn=s.forwardRef(Yn),Un=qn;function Gn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{d:"M3.75 3A1.75 1.75 0 002 4.75v3.26a3.235 3.235 0 011.75-.51h12.5c.644 0 1.245.188 1.75.51V6.75A1.75 1.75 0 0016.25 5h-4.836a.25.25 0 01-.177-.073L9.823 3.513A1.75 1.75 0 008.586 3H3.75zM3.75 9A1.75 1.75 0 002 10.75v4.5c0 .966.784 1.75 1.75 1.75h12.5A1.75 1.75 0 0018 15.25v-4.5A1.75 1.75 0 0016.25 9H3.75z"}))}const Xn=s.forwardRef(Gn),Jn=Xn;function Kn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1116 0 8 8 0 01-16 0zm6.39-2.908a.75.75 0 01.766.027l3.5 2.25a.75.75 0 010 1.262l-3.5 2.25A.75.75 0 018 12.25v-4.5a.75.75 0 01.39-.658z",clipRule:"evenodd"}))}const Qn=s.forwardRef(Kn),Vt=Qn;function Zn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M9.661 2.237a.531.531 0 01.678 0 11.947 11.947 0 007.078 2.749.5.5 0 01.479.425c.069.52.104 1.05.104 1.59 0 5.162-3.26 9.563-7.834 11.256a.48.48 0 01-.332 0C5.26 16.564 2 12.163 2 7c0-.538.035-1.069.104-1.589a.5.5 0 01.48-.425 11.947 11.947 0 007.077-2.75zm4.196 5.954a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"}))}const er=s.forwardRef(Zn),tr=er;function nr({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{d:"M15.98 1.804a1 1 0 00-1.96 0l-.24 1.192a1 1 0 01-.784.785l-1.192.238a1 1 0 000 1.962l1.192.238a1 1 0 01.785.785l.238 1.192a1 1 0 001.962 0l.238-1.192a1 1 0 01.785-.785l1.192-.238a1 1 0 000-1.962l-1.192-.238a1 1 0 01-.785-.785l-.238-1.192zM6.949 5.684a1 1 0 00-1.898 0l-.683 2.051a1 1 0 01-.633.633l-2.051.683a1 1 0 000 1.898l2.051.684a1 1 0 01.633.632l.683 2.051a1 1 0 001.898 0l.683-2.051a1 1 0 01.633-.633l2.051-.683a1 1 0 000-1.898l-2.051-.683a1 1 0 01-.633-.633L6.95 5.684zM13.949 13.684a1 1 0 00-1.898 0l-.184.551a1 1 0 01-.632.633l-.551.183a1 1 0 000 1.898l.551.183a1 1 0 01.633.633l.183.551a1 1 0 001.898 0l.184-.551a1 1 0 01.632-.633l.551-.183a1 1 0 000-1.898l-.551-.184a1 1 0 01-.633-.632l-.183-.551z"}))}const rr=s.forwardRef(nr),Pt=rr;function ar({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M.99 5.24A2.25 2.25 0 013.25 3h13.5A2.25 2.25 0 0119 5.25l.01 9.5A2.25 2.25 0 0116.76 17H3.26A2.267 2.267 0 011 14.74l-.01-9.5zm8.26 9.52v-.625a.75.75 0 00-.75-.75H3.25a.75.75 0 00-.75.75v.615c0 .414.336.75.75.75h5.373a.75.75 0 00.627-.74zm1.5 0a.75.75 0 00.627.74h5.373a.75.75 0 00.75-.75v-.615a.75.75 0 00-.75-.75H11.5a.75.75 0 00-.75.75v.625zm6.75-3.63v-.625a.75.75 0 00-.75-.75H11.5a.75.75 0 00-.75.75v.625c0 .414.336.75.75.75h5.25a.75.75 0 00.75-.75zm-8.25 0v-.625a.75.75 0 00-.75-.75H3.25a.75.75 0 00-.75.75v.625c0 .414.336.75.75.75H8.5a.75.75 0 00.75-.75zM17.5 7.5v-.625a.75.75 0 00-.75-.75H11.5a.75.75 0 00-.75.75V7.5c0 .414.336.75.75.75h5.25a.75.75 0 00.75-.75zm-8.25 0v-.625a.75.75 0 00-.75-.75H3.25a.75.75 0 00-.75.75V7.5c0 .414.336.75.75.75H8.5a.75.75 0 00.75-.75z",clipRule:"evenodd"}))}const sr=s.forwardRef(ar),Rt=sr;function or({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 019 9v.375M10.125 2.25A3.375 3.375 0 0113.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 013.375 3.375M9 15l2.25 2.25L15 12"}))}const lr=s.forwardRef(or),ir=lr;function cr({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"}))}const ur=s.forwardRef(cr),dr=ur;function fr({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"}))}const mr=s.forwardRef(fr),hr=mr;function pr({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z"}))}const vr=s.forwardRef(pr),gr=vr;function wr({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"}))}const xr=s.forwardRef(wr),Wt=xr;function br({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"}))}const Er=s.forwardRef(br),yr=Er;function q({title:e,to:t,icon:n,iconActive:r,classActive:i="px-2 bg-neutral-10",disabled:l=!1,children:c,before:d,className:h}){return o.jsx(nn,{title:e,to:t,className:({isActive:v})=>B("flex items-center",l&&"opacity-50 cursor-not-allowed",v&&_(l)&&i,h),style:({isActive:v})=>v||l?{pointerEvents:"none"}:{},children:({isActive:v})=>o.jsxs("span",{className:B("flex items-center",v?"font-bold":"font-normal"),children:[d,v?r:n,c]})})}function jr({className:e}){const{errors:t}=Mt(),n=E(l=>l.models),r=E(l=>l.modules),i=Array.from(new Set(n.values())).length;return o.jsxs("div",{className:e,children:[r.hasEditor&&o.jsx(q,{title:"File Explorer",to:Y.Editor,className:"px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-primary-500 rounded-xl my-1",classActive:"bg-primary-10 text-primary-500",icon:o.jsx(gr,{className:"min-w-6 w-6"}),iconActive:o.jsx(Jn,{className:"min-w-6 w-6"})}),r.hasDataCatalog&&o.jsx(q,{title:"Data Catalog",to:Y.DataCatalog,icon:o.jsx(dr,{className:"min-w-6 w-6"}),iconActive:o.jsx(Wn,{className:"min-w-6 w-6"}),className:"relative rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-600 dark:text-neutral-300",children:o.jsx("span",{className:"min-w-[1rem] px-1 h-4 py-0.5 text-center text-[9px] absolute bottom-0 right-0 font-black rounded-full bg-primary-500 text-primary-100",children:i})}),r.hasErrors&&o.jsx(q,{title:"Errors",to:Y.Errors,className:B("relative px-2 py-1 rounded-xl my-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10",t.size>0?"text-danger-500":"text-neutral-600"),classActive:"px-2 bg-danger-10 text-danger-500",icon:o.jsx(hr,{className:"w-6"}),iconActive:o.jsx(Un,{className:"w-6"}),disabled:t.size===0,children:t.size>0&&o.jsx("span",{className:"min-w-[1rem] px-1 h-4 py-0.5 text-center text-[9px] absolute bottom-0 right-0 font-black rounded-full bg-danger-500 text-danger-100",children:t.size})}),r.hasPlans&&o.jsx(q,{title:"Plan",to:Y.Plan,className:"px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-success-500 rounded-xl my-1",classActive:"bg-success-10 text-success-500",icon:o.jsx(Wt,{className:"w-6"}),iconActive:o.jsx(Vt,{className:"w-6"})}),r.hasTests&&o.jsx(q,{title:"Tests",to:Y.Tests,icon:o.jsx(ir,{className:"w-6"}),iconActive:o.jsx(Bn,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10"}),r.hasAudits&&o.jsx(q,{title:"Audits",to:Y.Audits,icon:o.jsx(yr,{className:"w-6"}),iconActive:o.jsx(tr,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10"}),r.hasData&&o.jsx(q,{title:"Data",to:Y.Data,icon:o.jsx(Rt,{className:"w-6"}),iconActive:o.jsx(Rt,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-500 dark:text-neutral-300"}),r.hasLineage&&o.jsx(q,{title:"Lineage",to:Y.Lineage,icon:o.jsx(Pt,{className:"w-6"}),iconActive:o.jsx(Pt,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-500 dark:text-neutral-300"})]})}function ft(e,t){let n=s.useRef([]),r=U(e);s.useEffect(()=>{let i=[...n.current];for(let[l,c]of t.entries())if(n.current[l]!==c){let d=r(t,i);return n.current=t,d}},[r,...t])}function Cr(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function kr(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}function Yt(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let n of e.current)n.current instanceof HTMLElement&&t.add(n.current);return t}let Tr="div";var qt=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(qt||{});function Ar(e,t){let n=s.useRef(null),r=me(n,t),{initialFocus:i,containers:l,features:c=30,...d}=e;Ot()||(c=1);let h=zt(n);Nr({ownerDocument:h},!!(c&16));let v=$r({ownerDocument:h,container:n,initialFocus:i},!!(c&2));Mr({ownerDocument:h,container:n,containers:l,previousActiveElement:v},!!(c&8));let x=En(),z=U(b=>{let p=n.current;p&&(A=>A())(()=>{xe(x.current,{[Ae.Forwards]:()=>{Re(p,de.First,{skipElements:[b.relatedTarget]})},[Ae.Backwards]:()=>{Re(p,de.Last,{skipElements:[b.relatedTarget]})}})})}),I=yn(),C=s.useRef(!1),G={ref:r,onKeyDown(b){b.key=="Tab"&&(C.current=!0,I.requestAnimationFrame(()=>{C.current=!1}))},onBlur(b){let p=Yt(l);n.current instanceof HTMLElement&&p.add(n.current);let A=b.relatedTarget;A instanceof HTMLElement&&A.dataset.headlessuiFocusGuard!=="true"&&(Ut(p,A)||(C.current?Re(n.current,xe(x.current,{[Ae.Forwards]:()=>de.Next,[Ae.Backwards]:()=>de.Previous})|de.WrapAround,{relativeTo:b.target}):b.target instanceof HTMLElement&&re(b.target)))}};return k.createElement(k.Fragment,null,!!(c&4)&&k.createElement(jt,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:z,features:Ct.Focusable}),he({ourProps:G,theirProps:d,defaultTag:Tr,name:"FocusTrap"}),!!(c&4)&&k.createElement(jt,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:z,features:Ct.Focusable}))}let Pr=fe(Ar),ve=Object.assign(Pr,{features:qt}),Z=[];kr(()=>{function e(t){t.target instanceof HTMLElement&&t.target!==document.body&&Z[0]!==t.target&&(Z.unshift(t.target),Z=Z.filter(n=>n!=null&&n.isConnected),Z.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function Rr(e=!0){let t=s.useRef(Z.slice());return ft(([n],[r])=>{r===!0&&n===!1&&Bt(()=>{t.current.splice(0)}),r===!1&&n===!0&&(t.current=Z.slice())},[e,Z,t]),U(()=>{var n;return(n=t.current.find(r=>r!=null&&r.isConnected))!=null?n:null})}function Nr({ownerDocument:e},t){let n=Rr(t);ft(()=>{t||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&re(n())},[t]),jn(()=>{t&&re(n())})}function $r({ownerDocument:e,container:t,initialFocus:n},r){let i=s.useRef(null),l=It();return ft(()=>{if(!r)return;let c=t.current;c&&Bt(()=>{if(!l.current)return;let d=e==null?void 0:e.activeElement;if(n!=null&&n.current){if((n==null?void 0:n.current)===d){i.current=d;return}}else if(c.contains(d)){i.current=d;return}n!=null&&n.current?re(n.current):Re(c,de.First)===Cn.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),i.current=e==null?void 0:e.activeElement})},[r]),i}function Mr({ownerDocument:e,container:t,containers:n,previousActiveElement:r},i){let l=It();Ht(e==null?void 0:e.defaultView,"focus",c=>{if(!i||!l.current)return;let d=Yt(n);t.current instanceof HTMLElement&&d.add(t.current);let h=r.current;if(!h)return;let v=c.target;v&&v instanceof HTMLElement?Ut(d,v)?(r.current=v,re(v)):(c.preventDefault(),c.stopPropagation(),re(h)):re(r.current)},!0)}function Ut(e,t){for(let n of e)if(n.contains(t))return!0;return!1}let mt=s.createContext(()=>{});mt.displayName="StackContext";var it=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(it||{});function Fr(){return s.useContext(mt)}function Sr({children:e,onUpdate:t,type:n,element:r,enabled:i}){let l=Fr(),c=U((...d)=>{t==null||t(...d),l(...d)});return dt(()=>{let d=i===void 0||i===!0;return d&&c(0,n,r),()=>{d&&c(1,n,r)}},[c,n,r,i]),k.createElement(mt.Provider,{value:c},e)}function Lr(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}const Dr=typeof Object.is=="function"?Object.is:Lr,{useState:Or,useEffect:zr,useLayoutEffect:Ir,useDebugValue:Hr}=et;function Br(e,t,n){const r=t(),[{inst:i},l]=Or({inst:{value:r,getSnapshot:t}});return Ir(()=>{i.value=r,i.getSnapshot=t,Ke(i)&&l({inst:i})},[e,r,t]),zr(()=>(Ke(i)&&l({inst:i}),e(()=>{Ke(i)&&l({inst:i})})),[e]),Hr(r),r}function Ke(e){const t=e.getSnapshot,n=e.value;try{const r=t();return!Dr(n,r)}catch{return!0}}function _r(e,t,n){return t()}const Vr=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Wr=!Vr,Yr=Wr?_r:Br,qr="useSyncExternalStore"in et?(e=>e.useSyncExternalStore)(et):Yr;function Ur(e){return qr(e.subscribe,e.getSnapshot,e.getSnapshot)}function Gr(e,t){let n=e(),r=new Set;return{getSnapshot(){return n},subscribe(i){return r.add(i),()=>r.delete(i)},dispatch(i,...l){let c=t[i].call(n,...l);c&&(n=c,r.forEach(d=>d()))}}}function Xr(){let e;return{before({doc:t}){var n;let r=t.documentElement;e=((n=t.defaultView)!=null?n:window).innerWidth-r.clientWidth},after({doc:t,d:n}){let r=t.documentElement,i=r.clientWidth-r.offsetWidth,l=e-i;n.style(r,"paddingRight",`${l}px`)}}}function Jr(){if(!Cr())return{};let e;return{before(){e=window.pageYOffset},after({doc:t,d:n,meta:r}){function i(l){return r.containers.flatMap(c=>c()).some(c=>c.contains(l))}n.microTask(()=>{if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let c=_t();c.style(t.documentElement,"scroll-behavior","auto"),n.add(()=>n.microTask(()=>c.dispose()))}n.style(t.body,"marginTop",`-${e}px`),window.scrollTo(0,0);let l=null;n.addEventListener(t,"click",c=>{if(c.target instanceof HTMLElement)try{let d=c.target.closest("a");if(!d)return;let{hash:h}=new URL(d.href),v=t.querySelector(h);v&&!i(v)&&(l=v)}catch{}},!0),n.addEventListener(t,"touchmove",c=>{c.target instanceof HTMLElement&&!i(c.target)&&c.preventDefault()},{passive:!1}),n.add(()=>{window.scrollTo(0,window.pageYOffset+e),l&&l.isConnected&&(l.scrollIntoView({block:"nearest"}),l=null)})})}}}function Kr(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function Qr(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let ne=Gr(()=>new Map,{PUSH(e,t){var n;let r=(n=this.get(e))!=null?n:{doc:e,count:0,d:_t(),meta:new Set};return r.count++,r.meta.add(t),this.set(e,r),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:n}){let r={doc:e,d:t,meta:Qr(n)},i=[Jr(),Xr(),Kr()];i.forEach(({before:l})=>l==null?void 0:l(r)),i.forEach(({after:l})=>l==null?void 0:l(r))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});ne.subscribe(()=>{let e=ne.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let r=t.get(n.doc)==="hidden",i=n.count!==0;(i&&!r||!i&&r)&&ne.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&ne.dispatch("TEARDOWN",n)}});function Zr(e,t,n){let r=Ur(ne),i=e?r.get(e):void 0,l=i?i.count>0:!1;return dt(()=>{if(!(!e||!t))return ne.dispatch("PUSH",e,n),()=>ne.dispatch("POP",e,n)},[t,e]),l}let Qe=new Map,ge=new Map;function Nt(e,t=!0){dt(()=>{var n;if(!t)return;let r=typeof e=="function"?e():e.current;if(!r)return;function i(){var c;if(!r)return;let d=(c=ge.get(r))!=null?c:1;if(d===1?ge.delete(r):ge.set(r,d-1),d!==1)return;let h=Qe.get(r);h&&(h["aria-hidden"]===null?r.removeAttribute("aria-hidden"):r.setAttribute("aria-hidden",h["aria-hidden"]),r.inert=h.inert,Qe.delete(r))}let l=(n=ge.get(r))!=null?n:0;return ge.set(r,l+1),l!==0||(Qe.set(r,{"aria-hidden":r.getAttribute("aria-hidden"),inert:r.inert}),r.setAttribute("aria-hidden","true"),r.inert=!0),i},[e,t])}var ea=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ea||{}),ta=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(ta||{});let na={0(e,t){return e.titleId===t.id?e:{...e,titleId:t.id}}},$e=s.createContext(null);$e.displayName="DialogContext";function Ee(e){let t=s.useContext($e);if(t===null){let n=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Ee),n}return t}function ra(e,t,n=()=>[document.body]){Zr(e,t,r=>{var i;return{containers:[...(i=r.containers)!=null?i:[],n]}})}function aa(e,t){return xe(t.type,na,e,t)}let sa="div",oa=kt.RenderStrategy|kt.Static;function la(e,t){var n;let r=be(),{id:i=`headlessui-dialog-${r}`,open:l,onClose:c,initialFocus:d,__demoMode:h=!1,...v}=e,[x,z]=s.useState(0),I=kn();l===void 0&&I!==null&&(l=(I&Pe.Open)===Pe.Open);let C=s.useRef(null),G=me(C,t),b=zt(C),p=e.hasOwnProperty("open")||I!==null,A=e.hasOwnProperty("onClose");if(!p&&!A)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!p)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!A)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof l!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${l}`);if(typeof c!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${c}`);let u=l?0:1,[V,Me]=s.useReducer(aa,{titleId:null,descriptionId:null,panelRef:s.createRef()}),X=U(()=>c(!1)),ye=U(y=>Me({type:0,id:y})),ae=Ot()?h?!1:u===0:!1,H=x>1,je=s.useContext($e)!==null,[Fe,Se]=Tn(),{resolveContainers:se,mainTreeNodeRef:J,MainTreeNode:Le}=An({portals:Fe,defaultContainers:[(n=V.panelRef.current)!=null?n:C.current]}),De=H?"parent":"leaf",pe=I!==null?(I&Pe.Closing)===Pe.Closing:!1,Oe=(()=>je||pe?!1:ae)(),Ce=s.useCallback(()=>{var y,L;return(L=Array.from((y=b==null?void 0:b.querySelectorAll("body > *"))!=null?y:[]).find(P=>P.id==="headlessui-portal-root"?!1:P.contains(J.current)&&P instanceof HTMLElement))!=null?L:null},[J]);Nt(Ce,Oe);let ze=(()=>H?!0:ae)(),Ie=s.useCallback(()=>{var y,L;return(L=Array.from((y=b==null?void 0:b.querySelectorAll("[data-headlessui-portal]"))!=null?y:[]).find(P=>P.contains(J.current)&&P instanceof HTMLElement))!=null?L:null},[J]);Nt(Ie,ze);let He=(()=>!(!ae||H))();Pn(se,X,He);let Be=(()=>!(H||u!==0))();Ht(b==null?void 0:b.defaultView,"keydown",y=>{Be&&(y.defaultPrevented||y.key===Rn.Escape&&(y.preventDefault(),y.stopPropagation(),X()))});let _e=(()=>!(pe||u!==0||je))();ra(b,_e,se),s.useEffect(()=>{if(u!==0||!C.current)return;let y=new ResizeObserver(L=>{for(let P of L){let ee=P.target.getBoundingClientRect();ee.x===0&&ee.y===0&&ee.width===0&&ee.height===0&&X()}});return y.observe(C.current),()=>y.disconnect()},[u,C,X]);let[Ve,We]=xn(),ke=s.useMemo(()=>[{dialogState:u,close:X,setTitleId:ye},V],[u,V,X,ye]),Te=s.useMemo(()=>({open:u===0}),[u]),Ye={ref:G,id:i,role:"dialog","aria-modal":u===0?!0:void 0,"aria-labelledby":V.titleId,"aria-describedby":Ve};return k.createElement(Sr,{type:"Dialog",enabled:u===0,element:C,onUpdate:U((y,L)=>{L==="Dialog"&&xe(y,{[it.Add]:()=>z(P=>P+1),[it.Remove]:()=>z(P=>P-1)})})},k.createElement(st,{force:!0},k.createElement(ot,null,k.createElement($e.Provider,{value:ke},k.createElement(ot.Group,{target:C},k.createElement(st,{force:!1},k.createElement(We,{slot:Te,name:"Dialog.Description"},k.createElement(ve,{initialFocus:d,containers:se,features:ae?xe(De,{parent:ve.features.RestoreFocus,leaf:ve.features.All&~ve.features.FocusLock}):ve.features.None},k.createElement(Se,null,he({ourProps:Ye,theirProps:v,slot:Te,defaultTag:sa,features:oa,visible:u===0,name:"Dialog"}))))))))),k.createElement(Le,null))}let ia="div";function ca(e,t){let n=be(),{id:r=`headlessui-dialog-overlay-${n}`,...i}=e,[{dialogState:l,close:c}]=Ee("Dialog.Overlay"),d=me(t),h=U(x=>{if(x.target===x.currentTarget){if(Nn(x.currentTarget))return x.preventDefault();x.preventDefault(),x.stopPropagation(),c()}}),v=s.useMemo(()=>({open:l===0}),[l]);return he({ourProps:{ref:d,id:r,"aria-hidden":!0,onClick:h},theirProps:i,slot:v,defaultTag:ia,name:"Dialog.Overlay"})}let ua="div";function da(e,t){let n=be(),{id:r=`headlessui-dialog-backdrop-${n}`,...i}=e,[{dialogState:l},c]=Ee("Dialog.Backdrop"),d=me(t);s.useEffect(()=>{if(c.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[c.panelRef]);let h=s.useMemo(()=>({open:l===0}),[l]);return k.createElement(st,{force:!0},k.createElement(ot,null,he({ourProps:{ref:d,id:r,"aria-hidden":!0},theirProps:i,slot:h,defaultTag:ua,name:"Dialog.Backdrop"})))}let fa="div";function ma(e,t){let n=be(),{id:r=`headlessui-dialog-panel-${n}`,...i}=e,[{dialogState:l},c]=Ee("Dialog.Panel"),d=me(t,c.panelRef),h=s.useMemo(()=>({open:l===0}),[l]),v=U(x=>{x.stopPropagation()});return he({ourProps:{ref:d,id:r,onClick:v},theirProps:i,slot:h,defaultTag:fa,name:"Dialog.Panel"})}let ha="h2";function pa(e,t){let n=be(),{id:r=`headlessui-dialog-title-${n}`,...i}=e,[{dialogState:l,setTitleId:c}]=Ee("Dialog.Title"),d=me(t);s.useEffect(()=>(c(r),()=>c(null)),[r,c]);let h=s.useMemo(()=>({open:l===0}),[l]);return he({ourProps:{ref:d,id:r},theirProps:i,slot:h,defaultTag:ha,name:"Dialog.Title"})}let va=fe(la),ga=fe(da),wa=fe(ma),xa=fe(ca),ba=fe(pa),Gt=Object.assign(va,{Backdrop:ga,Panel:wa,Overlay:xa,Title:ba,Description:wn});function ce({headline:e,type:t,changes:n,className:r}){const[i,l]=s.useState(!1);return o.jsx(Tt,{onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},className:"relative flex",children:()=>o.jsxs(o.Fragment,{children:[o.jsx("span",{className:B("transition-all flex min-w-[1rem] h-4 text-center mx-0.5 px-1 rounded-full text-[10px] font-black text-neutral-100 cursor-default border border-inherit",t===O.Add&&"bg-success-500 border-success-500",t===O.Remove&&"bg-danger-500 border-danger-500",t===O.Direct&&"bg-secondary-500 border-secondary-500",t===O.Indirect&&"bg-warning-500 border-warning-500",t===O.Metadata&&"bg-neutral-400 border-neutral-400",t===O.Default&&"bg-neutral-600 border-neutral-600",r),children:n.length}),o.jsx(lt,{show:i,as:s.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:o.jsx(Tt.Panel,{className:"absolute top-6 right-0 z-10 transform flex p-2 bg-theme-lighter shadow-xl focus:ring-2 ring-opacity-5 rounded-lg ",children:o.jsx(yt,{headline:e,type:t,className:"w-full h-full max-w-[50vw] max-h-[40vh] overflow-hidden overflow-y-auto hover:scrollbar scrollbar--vertical",children:o.jsx(yt.Default,{type:t,changes:n})})})})]})})}function Ea(){const e=j(i=>i.planOverview),[t,n]=s.useState(e);return s.useEffect(()=>{_(e.isEmpty)&&e.isFinished&&n(new gn(e))},[e]),(_(e.isLatest)||e.isFetching)&&t.hasUpdates?o.jsxs("span",{className:"flex group items-center bg-neutral-5 dark:bg-neutral-20 px-1 py-1 rounded-full",children:[(Ne(t.hasChanges)||Ne(t.hasBackfills))&&o.jsx($t,{className:"mr-2",children:"Changes"}),ie(t.added)&&o.jsx(ce,{headline:"Added",type:O.Add,changes:t.added,className:"-mr-2 group-hover:mr-0 z-[5]"}),ie(t.direct)&&o.jsx(ce,{headline:"Directly Modified",type:O.Direct,changes:t.direct,className:"-mr-2 group-hover:mr-0 z-[4]"}),ie(t.indirect)&&o.jsx(ce,{headline:"Indirectly Modified",type:O.Indirect,changes:t.indirect,className:"-mr-2 group-hover:mr-0 z-[3]"}),ie(t.metadata)&&o.jsx(ce,{headline:"Metadata",type:O.Metadata,changes:t.metadata,className:"-mr-2 group-hover:mr-0 z-[2]"}),ie(t.removed)&&o.jsx(ce,{headline:"Removed",type:O.Remove,changes:t.removed,className:"-mr-2 group-hover:mr-0 z-[1]"}),ie(t.backfills)?o.jsx(ce,{headline:"Backfills",type:O.Default,changes:t.backfills,className:"ml-4 group-hover:ml-2 z-[6]"}):o.jsx("div",{className:"ml-2 group-hover:ml-2 z-[6]"})]}):o.jsx($t,{className:"pr-2 pl-0.5 py-1 rounded-full bg-neutral-5 dark:bg-neutral-20 text-neutral-500 dark:text-neutral-300",children:"No Changes"})}function $t({className:e,children:t}){const n=E(h=>h.environment),r=E(h=>h.addRemoteEnvironments),i=j(h=>h.planAction),{refetch:l}=ct(),{refetch:c}=ut(n.name,{planOptions:{skip_tests:!0,include_unmodified:!0}});function d(h){const{environments:v,default_target_environment:x,pinned_environments:z}=h??{};St(v)&&r(Object.values(v),x,z)}return o.jsxs("p",{className:B("flex items-center text-xs text-neutral-600 dark:text-neutral-300 font-bold text-center whitespace-nowrap",e),children:[o.jsx(tt,{className:"w-5 h-5 !p-0 !m-0 !ml-0.5 !mr-1 border-none !rounded-full bg-neutral-10 dark:bg-neutral-20",variant:nt.Info,size:Ft.sm,disabled:i.isProcessing,onClick:h=>{h.stopPropagation(),l().then(({data:v})=>{c(),d(v)})},children:o.jsx(Ln,{className:"text-neutral-500 dark:text-neutral-300 w-4 h-4"})}),t]})}function Xt({children:e}){return o.jsxs(rn,{className:"inline-block",children:[o.jsx(rt,{className:"w-3 h-3 border border-neutral-10 mr-2"}),o.jsx("span",{className:"inline-block text-xs whitespace-nowrap",children:e})]})}let Ze;function ya(){const e=E(u=>u.modules),t=E(u=>u.environment),n=E(u=>u.models),r=j(u=>u.planAction),i=j(u=>u.planApply),l=j(u=>u.planOverview),c=j(u=>u.planCancel),d=j(u=>u.setPlanApply),h=j(u=>u.setPlanOverview),v=j(u=>u.setPlanCancel),x=j(u=>u.setPlanAction),z=j(u=>u.resetPlanTrackers),I=j(u=>u.clearPlanApply),{isFetching:C}=an(t.name),{isFetching:G}=sn(),{isFetching:b}=ct(),{refetch:p,isFetching:A}=ut(t.name,{planOptions:{skip_tests:!0,include_unmodified:!0}});return s.useEffect(()=>{n.size>0&&_(r.isProcessing)&&_(r.isRunningTask)&&(z(),I(),p())},[n,t]),s.useEffect(()=>{A&&(l.isFetching=!0,h(l)),C&&(i.isFetching=!0,d(i)),G&&(c.isFetching=!0,v(c))},[A,C,G]),s.useEffect(()=>{clearTimeout(Ze);const u=at.getPlanAction({planOverview:l,planApply:i,planCancel:c});u===ue.Done&&r.isRunningTask||u===r.value||(Ze=setTimeout(()=>{x(new at({value:u})),Ze=void 0},on([ue.Running,ue.RunningTask,ue.Cancelling,ue.Applying],u)?0:500))},[l,i,c]),o.jsx("div",{className:"min-h-8 max-h-8 flex w-full items-center justify-end text-neutral-500",children:b?o.jsx(Xt,{children:"Loading Environments..."}):o.jsxs(o.Fragment,{children:[_(e.hasOnlyPlans)&&_(e.hasOnlyPlansAndErrors)&&o.jsx(q,{title:r.isProcessing?r.displayStatus(l):"Plan",to:Y.Plan,icon:r.isProcessing?o.jsx(rt,{variant:nt.Success,className:"w-3 py-1"}):o.jsx(Wt,{className:B("w-5",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100")}),iconActive:r.isProcessing?o.jsx(rt,{variant:nt.Success,className:"w-3 py-1"}):o.jsx(Vt,{className:B("w-5",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100")}),before:o.jsx("p",{className:B("block mx-1 text-xs font-bold whitespace-nowrap",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100"),children:r.isProcessing?r.displayStatus(l):"Plan"}),className:B("px-2 rounded-full py-0.5 mr-1",l.isFailed?"bg-danger-10 dark:bg-danger-500":"bg-success-500"),classActive:B(l.isFailed?"bg-danger-10 dark:bg-danger-500":"bg-success-500")}),o.jsx("div",{className:"flex justify-center items-center min-w-[6rem] max-w-full",children:o.jsx(bn,{className:"border-none mx-2 w-full",size:Ft.sm,showAddEnvironment:!0,disabled:A||r.isProcessing||t.isInitialProd})}),o.jsx(Ea,{})]})})}function ja(){const e=Lt();return o.jsxs("div",{className:"flex",children:[o.jsx("button",{onClick:()=>e(-1),className:"inline-block text-neutral-700 dark:text-neutral-300 text-xs hover:bg-neutral-5 dark:hover:bg-neutral-10 px-1 py-1 rounded-full",children:o.jsx(zn,{className:"min-w-4 h-4"})}),o.jsx("button",{onClick:()=>e(1),className:"inline-block text-neutral-700 dark:text-neutral-300 text-xs hover:bg-neutral-5 dark:hover:bg-neutral-10 px-1 py-1 rounded-full",children:o.jsx($n,{className:"min-w-4 h-4"})})]})}function Ca(){const e=E(n=>n.modules),{isFetching:t}=Dt();return o.jsxs("div",{className:B("relative min-w-[10rem] px-2 min-h-[2rem] max-h-[2rem] w-full flex items-center",e.showHistoryNavigation?"justify-between":"justify-end",t&&"overflow-hidden"),children:[e.showHistoryNavigation&&o.jsx(ja,{}),t&&o.jsx("div",{className:"absolute w-full h-full flex justify-center items-center z-10 bg-transparent-20 backdrop-blur-lg",children:o.jsx(Xt,{children:"Loading Models..."})}),e.hasPlans&&o.jsx(ya,{}),e.hasErrors&&o.jsx(vn,{})]})}function ka({show:e,children:t,afterLeave:n,onClose:r=()=>{}}){return o.jsx(lt,{appear:!0,show:e,as:s.Fragment,afterLeave:n,children:o.jsxs(Gt,{as:"div",className:"relative z-50",onClose:r,children:[o.jsx("div",{className:"fixed inset-0 bg-overlay opacity-90"}),o.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:o.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:o.jsx(lt.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t})})})]})})}function S({show:e,children:t,onClose:n,afterLeave:r}){return o.jsx(ka,{show:e,onClose:n,afterLeave:r,children:o.jsx(Gt.Panel,{className:"min-w-[20rem] max-w-[50rem] transform rounded-xl bg-theme text-left align-middle shadow-xl transition-all overflow-hidden",children:t})})}function Ta({children:e}){return o.jsx("div",{className:"py-4 px-5 m-2",children:e})}function Aa({children:e}){return o.jsx("h2",{className:"font-bold text-xl mb-2",children:e})}function Pa({children:e}){return o.jsx("h4",{className:"font-bold",children:e})}function Ra({children:e}){return o.jsx("p",{className:"text-sm",children:e})}function Na({children:e}){return o.jsx("div",{className:"flex justify-end items-center py-3 px-3",children:e})}function $a({details:e}){return o.jsx("ul",{className:"my-2 p-4 bg-warning-10 rounded-md max-h-[20vh] overflow-y-auto hover:scrollbar scrollbar--vertical",children:e.map(t=>o.jsx("li",{className:"text-sm",children:t},t))})}S.Headline=Aa;S.Tagline=Pa;S.Description=Ra;S.Actions=Na;S.Main=Ta;S.Details=$a;const Ma=2e4,Fa=3e3;class Sa{constructor(t,n){le(this,"channels",new Map);le(this,"eventSource");le(this,"timerId");le(this,"source");le(this,"delay",Ma);this.source=t,this.delay=n??this.delay,this.setEventSource()}listen(t){t.addEventListener("error",n=>{this.reconnect(Fa)}),t.addEventListener("ping",n=>{this.reconnect(this.delay)})}cleanup(){var t;this.channels.forEach((n,r)=>{var i;F(n)&&((i=this.eventSource)==null||i.removeEventListener(r,n))}),(t=this.eventSource)==null||t.close(),this.eventSource=void 0}resubscribe(){this.channels.forEach((t,n)=>{var r;F(t)&&((r=this.eventSource)==null||r.addEventListener(n,t))})}reconnect(t){clearTimeout(this.timerId),this.timerId=setTimeout(()=>{console.log(`Reconnecting Event Source ${this.source}`),this.cleanup(),this.setEventSource(),this.resubscribe()},t)}getEventSource(){return new EventSource(this.source,{withCredentials:!0})}setEventSource(){this.eventSource=this.getEventSource(),this.listen(this.eventSource)}addChannel(t,n){var i;const r=this.getChannelHandler(t,n);(i=this.eventSource)==null||i.addEventListener(t,r),this.channels.set(t,r)}removeChannel(t){var r;const n=this.getChannel(t);F(n)&&((r=this.eventSource)==null||r.removeEventListener(t,n),this.channels.delete(t))}hasChannel(t){return F(this.getChannel(t))}getChannel(t){return this.channels.get(t)}getChannelHandler(t,n){return r=>{if(this.reconnect(this.delay),!(M(t)||M(n)||M(r.data)))try{n(JSON.parse(r.data))}catch(i){console.warn(i)}}}}let we;function La(){return M(we)&&(we=new Sa(ln("/api/events"))),(e,t)=>({subscribe(){F(e)&&F(t)&&_(we.hasChannel(e))&&we.addChannel(e,t)},unsubscribe(){we.removeChannel(e)}})}function ss({content:e}){const t=cn(),n=Lt(),{removeError:r,addError:i}=Mt(),l=E(a=>a.modules),c=E(a=>a.environment),d=E(a=>a.environments),h=E(a=>a.showConfirmation),v=E(a=>a.confirmations),x=E(a=>a.setShowConfirmation),z=E(a=>a.removeConfirmation),I=E(a=>a.setModels),C=E(a=>a.addRemoteEnvironments),G=E(a=>a.addLocalEnvironment),b=E(a=>a.setEnvironment);let p;_(l.hasOnlyDataCatalog)&&(p=La());const A=j(a=>a.planApply),u=j(a=>a.planOverview),V=j(a=>a.planCancel),Me=j(a=>a.setPlanApply),X=j(a=>a.setPlanOverview),ye=j(a=>a.setPlanCancel),ae=j(a=>a.setPlanAction),H=Q(a=>a.files),je=Q(a=>a.selectedFile),Fe=Q(a=>a.setProject),Se=Q(a=>a.setFiles),se=Q(a=>a.refreshFiles),J=Q(a=>a.findArtifactByPath),Le=Q(a=>a.setTests),De=Q(a=>a.setActiveRange),pe=te(a=>a.storedTabs),Oe=te(a=>a.storedTabId),Ce=te(a=>a.selectTab),ze=te(a=>a.createTab),Ie=te(a=>a.addTabs),He=te(a=>a.closeTab),Be=te(a=>a.inTabs),_e=E(a=>a.setVersion),{refetch:Ve,cancel:We}=un(),{refetch:ke,cancel:Te}=Dt(),{refetch:Ye,cancel:y}=dn(),{refetch:L,cancel:P}=ct(),{refetch:ee,cancel:Jt}=ut(c.name,{planOptions:{skip_tests:!0,include_unmodified:!0}}),oe=s.useCallback(function(f){const w=Array.from(d).find(g=>g.name===f);M(w)?G(f):b(w)},[d]),ht=s.useCallback(function(f){u.update(f),f.environment!==c.name&&oe(f.environment),X(u)},[oe,c]),pt=s.useCallback(function(f){var g,$;A.update(f,u),f.environment!==c.name&&oe(f.environment),Me(A);const w=Ne((g=f.meta)==null?void 0:g.done)&&(($=f.meta)==null?void 0:$.status)!==Ge.init;V.isFinished||V.isRunning||_(w)||L().then(({data:T})=>{ee(),xt(T)})},[V,u,oe,c]),vt=s.useCallback(function(f){var w,g;V.update(f),f.environment!==c.name&&oe(f.environment),ye(V),!(fn((w=f.meta)==null?void 0:w.done)||((g=f.meta)==null?void 0:g.status)===Ge.init)&&ee()},[oe,c]),gt=s.useCallback(function({changes:f,directories:w}){var g,$;f.sort(T=>T.change===Je.Deleted?-1:1),f.forEach(({change:T,path:K,file:R})=>{var N,W;if(T===Je.Modified){const D=H.get(K);if(M(D)||M(R))return;D.update(R)}if(T===Je.Deleted){const D=J(K)??H.get(K);if(M(D))return;D instanceof Xe&&((N=D.parent)==null||N.removeDirectory(D)),D instanceof At&&((W=D.parent)==null||W.removeFile(D),Be(D)&&He(D))}});for(const T in w){const K=w[T],R=J(T);M(R)||((g=K.directories)==null||g.forEach(N=>{const W=J(N.path);M(W)&&R.addDirectory(new Xe(N,R))}),($=K.files)==null||$.forEach(N=>{const W=H.get(N.path);M(W)&&R.addFile(new At(N,R))}),R.directories.sort((N,W)=>N.name>W.name?1:-1),R.files.sort((N,W)=>N.name>W.name?1:-1))}se(),De(),ke().then(({data:T})=>qe(T))},[H]),wt=s.useCallback(function(f){const w=H.get(f.path);F(w)&&(w.isFormatted=f.status===Ge.success,se())},[H]),Kt=s.useCallback(function(f){if(mn(pe))return;const w=pe.map(({id:$,content:T})=>{const K=f.find(N=>N.id===$)??Mn($),R=ze(K);return R.file.content=T??R.file.content??"",R}),g=w.find($=>$.file.id===Oe);Ie(w),F(g)&&M(je)&&Ce(g)},[Ce]);s.useEffect(()=>{Ve().then(({data:g})=>{_e(g==null?void 0:g.version),Ne(g==null?void 0:g.has_running_task)&&ae(new at({value:ue.RunningTask}))}),ke().then(({data:g})=>qe(g));const a=p==null?void 0:p("errors",Qt),f=p==null?void 0:p("tests",Zt),w=p==null?void 0:p("models",qe);return w==null||w.subscribe(),l.hasPlans&&(f==null||f.subscribe(),L().then(({data:g})=>xt(g))),l.hasErrors&&(a==null||a.subscribe()),l.hasFiles&&Ye().then(({data:g})=>{if(M(g))return;const $=new Xe(g),T=$.allFiles;Kt(T),Se(T),Fe($)}),()=>{We(),Te(),w==null||w.unsubscribe(),l.hasPlans&&(P(),Jt()),l.hasErrors&&(a==null||a.unsubscribe()),l.hasTests&&(f==null||f.unsubscribe()),l.hasFiles&&y()}},[l]),s.useEffect(()=>{const a=p==null?void 0:p("plan-apply",pt);return l.hasPlans&&(a==null||a.subscribe()),()=>{l.hasPlans&&(a==null||a.unsubscribe())}},[pt,l]),s.useEffect(()=>{const a=p==null?void 0:p("plan-overview",ht);return l.hasPlans&&(a==null||a.subscribe()),()=>{l.hasPlans&&(a==null||a.unsubscribe())}},[ht,l]),s.useEffect(()=>{const a=p==null?void 0:p("plan-cancel",vt);return l.hasPlans&&(a==null||a.subscribe()),()=>{l.hasPlans&&(a==null||a.unsubscribe())}},[vt,l]),s.useEffect(()=>{const a=p==null?void 0:p("file",gt);return a==null||a.subscribe(),()=>{a==null||a.unsubscribe()}},[gt]),s.useEffect(()=>{const a=p==null?void 0:p("format-file",wt);return a==null||a.subscribe(),()=>{a==null||a.unsubscribe()}},[wt]),s.useEffect(()=>{(_(l.isEmpty)&&t.pathname===Y.Home||t.pathname==="")&&n(l.defaultNavigationRoute(),{replace:!0})},[t,l]),s.useEffect(()=>{x(v.length>0)},[v]);function qe(a){F(a)&&(r(bt.Models),I(a))}function Qt(a){i(bt.General,a)}function Zt(a){Le(a)}function xt(a){const{environments:f,default_target_environment:w,pinned_environments:g}=a??{};St(f)&&C(Object.values(f),w,g)}function Ue(a){var f;(f=a==null?void 0:a.cancel)==null||f.call(a),x(!1)}const m=v[0];return o.jsxs(hn.Page,{layout:"horizontal",children:[l.showModuleNavigation&&o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"overflow-hidden py-1 px-2 flex flex-col items-center"}),o.jsx(Et,{orientation:"vertical"})]}),o.jsxs("div",{className:"flex flex-col overflow-hidden w-full h-full",children:[l.showNavigation&&o.jsxs(o.Fragment,{children:[o.jsx(Ca,{}),o.jsx(Et,{})]}),e??o.jsx(pn,{}),o.jsxs(S,{show:h,onClose:()=>{Ue(m)},afterLeave:()=>{z()},onKeyDown:a=>{a.key==="Escape"&&Ue(m)},children:[o.jsxs(S.Main,{children:[F(m==null?void 0:m.headline)&&o.jsx(S.Headline,{children:m==null?void 0:m.headline}),F(m==null?void 0:m.tagline)&&o.jsx(S.Tagline,{children:m==null?void 0:m.tagline}),F(m==null?void 0:m.details)&&o.jsx(S.Details,{details:m==null?void 0:m.details}),F(m==null?void 0:m.description)&&o.jsx(S.Description,{children:m==null?void 0:m.description}),m==null?void 0:m.children]}),o.jsxs(S.Actions,{children:[o.jsx(tt,{className:"font-bold",size:"md",variant:"danger",onClick:a=>{var f;a.stopPropagation(),(f=m==null?void 0:m.action)==null||f.call(m),x(!1)},children:(m==null?void 0:m.yesText)??"Confirm"}),o.jsx(tt,{size:"md",variant:"alternative",onClick:a=>{a.stopPropagation(),Ue(m)},children:(m==null?void 0:m.noText)??"Cancel"})]})]})]})]})}export{ss as default};
